\section{(Q2) - Question \#2}
\label{sec:Q2}

Derive the right eigenvectors $r_1$, $r_2$, and $r_3$ for the matrix $A$ (Equation \ref{eq:matrix_A}).
Note that:

\begin{equation}
    Q_A = \begin{bmatrix}
        r_1 & r_2 & r_3
    \end{bmatrix}
\end{equation}

\subsection{Solution}

The right eigenvectors $r_1$, $r_2$, and $r_3$ of the matrix $A$ are defined as the eigenvectors that satisfy the following equation:

\begin{equation}
    A Q_A = Q_A \Lambda
\end{equation}

where $\Lambda$ is the diagonal matrix of the eigenvalues of $A$ and $Q_A$ is the matrix of the right eigenvectors of $A$.

To solve the eigenvalues and eigenvectors problem, we can use its characteristic equation:

\begin{equation}
    \text{det}(A - \lambda I) = 0
\end{equation}

where $I$ is the identity matrix.

The characteristic equation for the matrix $A$ is:

\begin{equation}
    \text{det}(A - \lambda I) = \text{det}\left( \begin{bmatrix}
            -\lambda                      & 1                                        & 0                  \\
            \frac{\gamma - 3}{2} u^2      & (3 - \gamma) u - \lambda                 & \gamma - 1         \\
            (\gamma - 1) u^3 - \gamma u E & -\frac{3}{2} (\gamma - 1) u^2 + \gamma E & \gamma u - \lambda
        \end{bmatrix} \right) = 0
\end{equation}

Expanding the determinant, we get:

\begin{align}
     & -\lambda \left[ \left( (3 - \gamma) u - \lambda \right) \left(\gamma u - \lambda\right) - \left(-\frac{3}{2} (\gamma - 1) u^2 \right) \left( \gamma - 1\right) \right] + \dots \\
     & - 1 \left[ \left( \frac{\gamma - 3}{2} u^2 \right) \left( \gamma u - \lambda \right) - \left( (\gamma - 1) u^3 - \gamma u E \right) \left( \gamma - 1 \right) \right] = 0
\end{align}

Solving the characteristic equation, we find the eigenvalues of the matrix $A$:

\begin{equation}
    \Lambda = diag(\begin{bmatrix}
        u & u + a & u - a
    \end{bmatrix})
    \label{eq:matrix_Lambda}
\end{equation}

where $a = \sqrt{\gamma p / \rho}$ is the speed of sound.

The right eigenvectors $r_1$, $r_2$, and $r_3$ of the matrix $A$ are:

\begin{equation}
    r_1 = \begin{bmatrix}
        1 \\
        u \\
        \frac{u^2}{2}
    \end{bmatrix}, \quad
    r_2 = \begin{bmatrix}
        1     \\
        u + a \\
        H + u a
    \end{bmatrix}, \quad
    r_3 = \begin{bmatrix}
        1     \\
        u - a \\
        H - u a
    \end{bmatrix}
    \label{eq:right_eigenvectors}
\end{equation}

where $H = E + p / \rho$ is the enthalpy.

If we rewrite the right eigenvectors in terms of the primitive variables contained in the vector $U$, and adjust the modulus of each eigenvector to match the one of the $Q_A$ reported in \cite{Steger-Warming}, we get:

\begin{equation}
    Q_A = \begin{bmatrix}
        r_1 & r_2 & r_3
    \end{bmatrix} = \begin{bmatrix}
        1             & \frac{\rho}{2c}                                                & - \frac{\rho}{2c}                                                \\
        u             & \frac{\rho}{2c} (u + a)                                        & - \frac{\rho}{2c} (u - a)                                        \\
        \frac{u^2}{2} & \frac{\rho}{2c} (\frac{u^2}{2} + \frac{a^2}{\gamma - 1} + u a) & - \frac{\rho}{2c} (\frac{u^2}{2} + \frac{a^2}{\gamma - 1} - u a)
    \end{bmatrix}
    \label{eq:matrix_Q_A}
\end{equation}

The code of Mathematica used to derive the right eigenvectors $r_1$, $r_2$, and $r_3$ is reported below:

\lstinputlisting[
    style=mathematica,
    language=Mathematica,
    caption=Mathematica notebook for Q2.,
]{files/Q2.txt}


