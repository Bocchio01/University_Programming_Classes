\section{(Q3) - Question \#3}
\label{sec:Q3}

Derive the following flux-vector splitting:

\begin{equation}
    F^\pm = \left( \frac{\rho}{2\gamma} \right) \begin{bmatrix}
        2(\gamma - 1) \lambda_1^\pm + \lambda_2^\pm + \lambda_3^\pm                  \\
        (2 - \gamma) \lambda_1^\pm u + \lambda_2^\pm (u + a) + \lambda_3^\pm (u - a) \\
        (\gamma - 1) \lambda_1^\pm u^2 + \frac{\lambda_2^\pm}{2} (u + a)^2 + \frac{\lambda_3^\pm}{2} (u - a)^2 + \frac{3-\gamma}{2(\gamma - 1)} (\lambda_2^\pm + \lambda_3^\pm) a^2
    \end{bmatrix}
    \label{eq:flux_vector_splitting}
\end{equation}

Which is equivalent to the following:

\begin{equation}
    F^\pm = \frac{1}{\gamma} Q_A \begin{bmatrix}
        (\gamma - 1) \rho \lambda_1^\pm \\
        a \lambda_2^\pm                 \\
        -a \lambda_3^\pm
    \end{bmatrix}
\end{equation}

Where $Q_A$ is the eigenvector matrix (Equations \ref{eq:matrix_Q_A}).

\subsection{Solution}

We know that the flux-vector $F$ can be expressed as:

\begin{equation}
    F = A U = Q_A \Lambda Q_A^{-1} U
\end{equation}

In order to proof the given flux-vector splitting, we will perform the matrix multiplication given the definitions of the eigenvector matrix $Q_A$ (Equation \ref{eq:matrix_Q_A}) and the diagonal matrix of the eigenvalues $\Lambda$ (Equation \ref{eq:matrix_Lambda}).

The flux-vector splitting can be expressed as follows:

\begin{equation}
    F^\pm = \begin{bmatrix}
        \frac{\rho  (-a+2 \gamma  \lambda_1^\pm-2 \lambda_1^\pm+\lambda_2^\pm+u)}{2 \gamma }                                                                                                        \\
        \frac{\rho  \left(a^2+a (\lambda_2^\pm-2 u)+u (2 (\gamma -1) \lambda_1^\pm+\lambda_2^\pm+u)\right)}{2 \gamma }                                                                              \\
        \frac{\rho  \left(-2 a^3+2 a^2 (\lambda_2^\pm+\gamma  u)-a (\gamma -1) u (3 u-2 \lambda_2^\pm)+(\gamma -1) u^2 (2 (\gamma -1) \lambda_1^\pm+\lambda_2^\pm+u)\right)}{4 (\gamma -1) \gamma } \\
    \end{bmatrix}
\end{equation}

From here, we still can't see the equivalence with the given expression.

We can now compute the coefficients that multiply each $\lambda_i^\pm$.
For simplicity, we will consider the expression $\frac{F^\pm}{\frac{\rho}{2*\gamma}}$, obtaining the following coefficient matrix ($[\text{Known term}, \text{Coef}_{\lambda_1}, \text{Coef}_{\lambda_2}, \text{Coef}_{\lambda_3}]$)

\begin{equation}
    \text{CoefficientList} = \begin{bmatrix}
        u-a                                                   & 2 (\gamma -1)    & 1                                           & 0 \\
        (a-u)^2                                               & 2 (\gamma - 1) u & a+u                                         & 0 \\
        \frac{1}{2} (u-a) (\frac{2 a^2}{\gamma -1}-2 a u+u^2) & (\gamma -1) u^2  & \frac{a^2}{\gamma -1} + a u + \frac{u^2}{2} & 0 \\
    \end{bmatrix}
\end{equation}

From now on, we can carry on the computation of the coefficients by hand, simplifying the coefficient and obtaining the desired result.

\begin{align}
    F^\pm & = \frac{\rho}{2\gamma} \begin{bmatrix}
                                       u-a                                                   & + & 2 (\gamma -1) \lambda_1^\pm    & + & 1    \lambda_2^\pm                                          & + & 0 \lambda_3^\pm \\
                                       (a-u)^2                                               & + & 2 (\gamma - 1) u \lambda_1^\pm & + & a+u  \lambda_2^\pm                                          & + & 0 \lambda_3^\pm \\
                                       \frac{1}{2} (u-a) (\frac{2 a^2}{\gamma -1}-2 a u+u^2) & + & (\gamma -1) u^2 \lambda_1^\pm  & + & (\frac{a^2}{\gamma -1} + a u + \frac{u^2}{2}) \lambda_2^\pm & + & 0 \lambda_3^\pm
                                   \end{bmatrix} =         \\
          & =   \frac{\rho}{2\gamma} \begin{bmatrix}
                                         \lambda_3^\pm + 2 (\gamma -1) \lambda_1^\pm                                                                 + \lambda_2^\pm       \\
                                         \lambda_3^\pm (a+u) + 2 (\gamma - 1) u \lambda_1^\pm                                                        + \lambda_2^\pm (a+u) \\
                                         \frac{\lambda_3^\pm}{2} (u^2 - 2 a u + a^2 + \frac{2 a^2}{\gamma -1} - a^2) + (\gamma -1) u^2 \lambda_1^\pm + \frac{\lambda_2^\pm}{2} (u^2 - 2 a u + a^2 + \frac{2 a^2}{\gamma -1} - a^2)
                                     \end{bmatrix} = \\
          & = \frac{\rho}{2\gamma} \begin{bmatrix}
                                       2 (\gamma -1) \lambda_1^\pm + \lambda_2^\pm + \lambda_3^\pm                   \\
                                       2 (\gamma -1) \lambda_1^\pm u + \lambda_2^\pm (u + a) + \lambda_3^\pm (u - a) \\
                                       (\gamma - 1) \lambda_1^\pm u^2 + \frac{\lambda_2^\pm}{2} (u + a)^2 + \frac{\lambda_3^\pm}{2} (u - a)^2 + \frac{3-\gamma}{2(\gamma - 1)} (\lambda_2^\pm + \lambda_3^\pm) a^2
                                   \end{bmatrix}
    \label{eq:Q3_result}
\end{align}

The result in Equation \ref{eq:Q3_result} is equivalent to the given expression in Equation \ref{eq:flux_vector_splitting}.

The code of Mathematica used to derive the coefficients list:

\lstinputlisting[
    style=mathematica,
    language=Mathematica,
    caption=Mathematica notebook for Q3.,
]{files/Q3.txt}


